<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>메모</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: white; /* 전체 배경을 흰색으로 */
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            overflow-y: scroll; /* 스크롤바는 있으나, 내용이 넘칠 때만 보이도록 */
        }
        
        /* 스크롤바 숨김 (IE, Edge, Firefox, Chrome, Safari 호환) */
        body::-webkit-scrollbar {
            display: none; /* Chrome, Safari */
        }
        body {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }

        #editor-container {
            /* 최대 폭(800px) 및 중앙 정렬 마진 제거 -> 창 크기에 따라 100% 폭으로 가변 */
            width: 100%; 
            background-color: white;
        }
        
        #content {
            font-size: 1.28rem; /* 폰트 크기를 1.28rem으로 변경 */
            line-height: 1.6;
            caret-color: #333; /* 커서 색상 */
            color: #1f2937; /* text-gray-800에 해당하는 색상 */
            min-height: 100vh;
            padding-top: 2rem; /* 상단 여백 유지 */
            padding-bottom: 50vh; /* 하단 여백 유지 */
            padding-left: 1.5rem; /* 좌측 여백을 1.5rem으로 설정 */
            padding-right: 1.5rem; /* 우측 여백을 1.5rem으로 설정 */
        }

        #content:focus {
            outline: none;
        }

        #content b, #content strong { font-weight: 700; }
        #content u { text-decoration: underline; }

        #content img {
            max-width: 100%;
            height: auto;
            margin: 1rem 0;
            display: block;
        }
    </style>
</head>
<body class="p-0 m-0">

    <div id="editor-container">
        <div id="content" 
             contenteditable="true" 
             class="max-w-none" /* prose 클래스를 제거하고 최소 클래스만 유지 */
             data-placeholder="여기에 메모를 시작하세요..."
             role="textbox" 
             aria-multiline="true">
        </div>
    </div>

    <script>
        const content = document.getElementById('content');
        // CSS에서 1.28rem으로 설정된 초기 폰트 크기를 가져옵니다.
        let currentFontSizePx = parseFloat(getComputedStyle(content).fontSize); 

        function adjustFontSize(delta) {
            currentFontSizePx = Math.max(12, Math.min(32, currentFontSizePx + delta));
            content.style.fontSize = `${currentFontSizePx}px`;
        }

        document.addEventListener('keydown', (e) => {
            const isModifier = e.metaKey || e.ctrlKey;

            if (isModifier) {
                if (e.key === 'b') {
                    e.preventDefault();
                    document.execCommand('bold', false, null);
                } else if (e.key === 'u') {
                    e.preventDefault();
                    document.execCommand('underline', false, null);
                } else if (e.key === '=') {
                    e.preventDefault();
                    adjustFontSize(2);
                } else if (e.key === '-') {
                    e.preventDefault();
                    adjustFontSize(-2);
                }
            } else if (e.key === 'Tab') { // Tab 키 기능 추가
                e.preventDefault();
                const selection = window.getSelection();
                const range = selection.getRangeAt(0);

                // 4개의 공백 노드 생성
                const tabNode = document.createTextNode('\u00a0\u00a0\u00a0\u00a0'); // &nbsp;는 contenteditable에서 작동하지 않을 수 있으므로 유니코드 공백을 사용
                
                range.deleteContents();
                range.insertNode(tabNode);

                // 커서를 삽입된 공백 뒤로 이동
                range.setStartAfter(tabNode);
                range.setEndAfter(tabNode);
                selection.removeAllRanges();
                selection.addRange(range);
            }
        });

        content.addEventListener('paste', (event) => {
            const items = (event.clipboardData || event.originalEvent.clipboardData).items;
            for (let i = 0; i < items.length; i++) {
                if (items[i].type.indexOf('image') !== -1) {
                    const file = items[i].getAsFile();
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            const img = document.createElement('img');
                            img.src = e.target.result;
                            img.alt = '붙여넣은 이미지';
                            
                            const selection = window.getSelection();
                            if (selection.rangeCount > 0) {
                                const range = selection.getRangeAt(0);
                                range.deleteContents();
                                range.insertNode(img);
                                range.collapse(false);
                                
                                const br = document.createElement('br');
                                range.insertNode(br);
                                range.collapse(false);
                            } else {
                                content.appendChild(img);
                                content.appendChild(document.createElement('br'));
                            }
                        };
                        reader.readAsDataURL(file);
                        event.preventDefault();
                        return;
                    }
                }
            }
        });

        window.onload = () => {
            content.focus();
        };
    </script>
</body>
</html>
