<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binhu Pulsology Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans', sans-serif;
            background-color: #FDFBF5; /* Soft beige background */
        }
        .quiz-card {
            background-color: #FFFFFF;
            border: 1px solid #EAE0D5;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        .btn-choice {
            background-color: #FFF8F0;
            border: 1px solid #EAE0D5;
            transition: all 0.2s ease-in-out;
        }
        .btn-choice:hover {
            background-color: #FCEFE1;
            transform: translateY(-2px);
        }
        .btn-choice.correct {
            background-color: #D1FAE5; /* Correct Answer: Green */
            border-color: #6EE7B7;
            color: #065F46;
        }
        .btn-choice.incorrect {
            background-color: #FEE2E2; /* Incorrect Answer: Red */
            border-color: #FCA5A5;
            color: #991B1B;
        }
        .btn-next {
            background-color: #A07C5B; /* Darker beige */
            color: white;
            transition: background-color 0.2s ease;
        }
        .btn-next:hover {
            background-color: #8A6A4D;
        }
        .progress-bar-bg {
            background-color: #EAE0D5;
        }
        .progress-bar-fill {
            background-color: #A07C5B;
            transition: width 0.5s ease-in-out;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div id="quiz-container" class="w-full max-w-2xl mx-auto">
        <div class="quiz-card rounded-xl p-6 md:p-8">
            <div id="start-screen">
                <h1 class="text-3xl font-bold text-center text-[#4A3F35] mb-4">Binhu Pulsology Quiz</h1>
                <p class="text-center text-gray-600 mb-8">Match the correct pulse (脈) based on the given information.</p>
                <button id="start-btn" class="w-full btn-next font-bold py-3 px-4 rounded-lg text-lg">Start Quiz</button>
            </div>

            <div id="quiz-screen" class="hidden">
                <!-- Progress and Score -->
                <div class="flex justify-between items-center mb-4">
                    <p class="text-sm font-semibold text-[#A07C5B]">Question <span id="current-question"></span> / <span id="total-questions"></span></p>
                    <p class="text-sm font-semibold text-[#A07C5B]">Score: <span id="score">0</span></p>
                </div>

                <!-- Progress Bar -->
                <div class="progress-bar-bg w-full h-2 rounded-full mb-6">
                    <div id="progress-bar" class="progress-bar-fill h-2 rounded-full" style="width: 0%;"></div>
                </div>

                <!-- Question Area -->
                <div class="mb-6 min-h-[120px] bg-stone-50 p-4 rounded-lg border border-stone-200">
                    <p id="pattern" class="text-lg font-bold text-[#4A3F35] mb-2"></p>
                    <p id="description" class="text-base text-gray-700"></p>
                </div>

                <!-- Choices -->
                <div id="choices" class="grid grid-cols-2 md:grid-cols-3 gap-3">
                    <!-- Choice buttons are generated by JS -->
                </div>

                <!-- Next Button -->
                <div class="mt-8 text-center">
                    <button id="next-btn" class="w-full md:w-1/2 btn-next font-bold py-3 px-4 rounded-lg hidden">Next Question</button>
                </div>
            </div>

            <div id="result-screen" class="hidden text-center">
                 <h2 class="text-3xl font-bold text-[#4A3F35] mb-4">Quiz Results</h2>
                 <p class="text-xl text-gray-700 mb-2">You answered <strong id="final-score" class="text-2xl text-[#A07C5B]"></span> out of <span id="final-total"></span> questions correctly!</p>
                 <p id="result-message" class="text-lg font-medium mt-4 mb-8"></p>
                 <button id="restart-btn" class="w-full btn-next font-bold py-3 px-4 rounded-lg text-lg">Try Again</button>
            </div>
        </div>
        <footer class="text-center mt-4">
            <p class="text-xs text-gray-400">Quiz generated by Gemini.</p>
        </footer>
    </div>

    <script>
        const quizData = [
            { pulse: "Floating Pulse (Fú Mài)", pattern: "Exterior Pattern", description: "Forceful when touched lightly, but feels weak when pressed down firmly. It feels like a light breeze gently moving a bird's feathers, like rubbing an elm pod, like a piece of wood floating on water, or like twisting a green onion leaf." },
            { pulse: "Sinking Pulse (Chén Mài)", pattern: "Interior Pattern", description: "Can only be felt when one presses down firmly to the level of the tendons and bones. It is like sand wrapped in cotton—hard on the inside but soft on the outside. It can also be compared to a stone thrown into water that sinks all the way to the bottom." },
            { pulse: "Slow Pulse (Chí Mài)", pattern: "Cold Pattern", description: "Has three beats per respiration cycle (one inhalation and one exhalation), and its movement is very slow." },
            { pulse: "Rapid Pulse (Shuò Mài)", pattern: "Heat Pattern", description: "Has six beats per respiration cycle, and the flow of the pulse feels very urgent and swift." },
            { pulse: "Deficient Pulse (Xū Mài)", pattern: "Qi Deficiency", description: "Slow, large, and soft. It feels forceless when pressed. Under the fingertips, it feels faint and suddenly empty." },
            { pulse: "Weak Pulse (Ruò Mài)", pattern: "Blood Deficiency", description: "Feels extremely soft, deep (sinking), and thin. It can only be perceived with firm pressure and cannot be felt with a light touch." },
            { pulse: "Excess Pulse (Shí Mài)", pattern: "Excess Pattern", description: "Can be felt at both the superficial (floating) and deep (sinking) levels. The pulse shape is large and long, feels slightly wiry, and gives a strong, forceful beat against the fingertips." },
            { pulse: "Slippery Pulse (Huá Mài)", pattern: "Dampness, Phlegm", description: "Comes and goes smoothly and fluently. Its continuous arrival feels like round pearls rolling under the fingertips, or like it is about to slip away from the hand." },
            { pulse: "Choppy Pulse (Sè Mài)", pattern: "Blood Stasis", description: "Thin and slow, its movement is not smooth, and its form feels short and scattered. It is like scraping bamboo with a light knife, like rainwater seeping into sand, or like a sick silkworm eating a leaf." },
            { pulse: "Wiry Pulse (Xián Mài)", pattern: "Liver Qi Stagnation", description: "Feels straight, long, and taut, like a bowstring pulled tight. It does not shift when pressed, and its long, tense quality is like pressing on the string of a zither or lute." },
            { pulse: "Tight Pulse (Jǐn Mài)", pattern: "Cold Pattern", description: "Forceful in its coming and going and can be felt on both the left and right sides of the vessel. Its feeling is like the vibration of a twisting rope." },
            { pulse: "Moderate Pulse (Huǎn Mài)", pattern: "Normal, Dampness", description: "Slightly faster than the Slow pulse, with four beats per respiration cycle. It is like a thread on a loom that is not pulled taut, and its rhythm is very even." },
            { pulse: "Soggy Pulse (Rú Mài)", pattern: "Dampness, Phlegm", description: "Extremely soft, floating, and thin. It feels like cotton floating on water; it can be felt with a light touch but disappears when pressed." },
            { pulse: "Hasty Pulse (Cù Mài)", pattern: "Blood Stasis", description: "Rapid in its coming and going, but it sometimes stops and then resumes. Its rhythm is irregular, like a stumbling person trying to walk quickly." },
            { pulse: "Knotted Pulse (Jié Mài)", pattern: "Blood Stasis", description: "Slow and occasionally stops before resuming." },
            { pulse: "Intermittent Pulse (Dài Mài)", pattern: "Blood Stasis", description: "Stops during its beat for a relatively long time before returning to its original rhythm." },
            { pulse: "Thready Pulse (Xì Mài)", pattern: "Blood Deficiency / Yin Deficiency, Dryness", description: "Slightly larger than the Faint pulse (Wei Mai) and can always be felt. Its form is thin, straight, and soft, feeling like a single silk thread under the finger." }
        ];

        // DOM elements
        const startScreen = document.getElementById('start-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultScreen = document.getElementById('result-screen');

        const startBtn = document.getElementById('start-btn');
        const nextBtn = document.getElementById('next-btn');
        const restartBtn = document.getElementById('restart-btn');

        const currentQuestionEl = document.getElementById('current-question');
        const totalQuestionsEl = document.getElementById('total-questions');
        const scoreEl = document.getElementById('score');
        const progressBar = document.getElementById('progress-bar');

        const patternEl = document.getElementById('pattern');
        const descriptionEl = document.getElementById('description');
        const choicesEl = document.getElementById('choices');

        const finalScoreEl = document.getElementById('final-score');
        const finalTotalEl = document.getElementById('final-total');
        const resultMessageEl = document.getElementById('result-message');

        // Quiz state variables
        let questions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        const QUIZ_LENGTH = 10;

        // Function to start the quiz
        function startQuiz() {
            // Reset state
            currentQuestionIndex = 0;
            score = 0;
            scoreEl.textContent = 0;
            
            // Shuffle questions and select 10
            questions = quizData.sort(() => 0.5 - Math.random()).slice(0, QUIZ_LENGTH);
            totalQuestionsEl.textContent = QUIZ_LENGTH;

            // Switch screens
            startScreen.classList.add('hidden');
            resultScreen.classList.add('hidden');
            quizScreen.classList.remove('hidden');

            // Show the first question
            showQuestion();
        }

        // Function to display a question
        function showQuestion() {
            // Clear previous choices and hide next button
            choicesEl.innerHTML = '';
            nextBtn.classList.add('hidden');

            // Get current question
            const currentQuestion = questions[currentQuestionIndex];
            
            // Update question info
            patternEl.textContent = currentQuestion.pattern;
            descriptionEl.textContent = currentQuestion.description;
            currentQuestionEl.textContent = currentQuestionIndex + 1;
            
            // Update progress bar
            const progress = ((currentQuestionIndex + 1) / QUIZ_LENGTH) * 100;
            progressBar.style.width = `${progress}%`;

            // Create choice buttons
            const choices = getChoices(currentQuestion.pulse);
            choices.forEach(choice => {
                const button = document.createElement('button');
                button.textContent = choice;
                button.classList.add('btn-choice', 'p-4', 'rounded-lg', 'text-left', 'font-medium', 'text-gray-800');
                button.onclick = () => selectAnswer(button, choice, currentQuestion.pulse);
                choicesEl.appendChild(button);
            });
        }

        // Function to get 6 choices (1 correct, 5 incorrect)
        function getChoices(correctAnswer) {
            let choices = [correctAnswer];
            let wrongAnswers = quizData
                .map(q => q.pulse)
                .filter(p => p !== correctAnswer);
            
            wrongAnswers.sort(() => 0.5 - Math.random());

            // Get 5 wrong answers
            for (let i = 0; i < 5; i++) {
                if(wrongAnswers[i]) {
                    choices.push(wrongAnswers[i]);
                }
            }

            // Shuffle choices
            return choices.sort(() => 0.5 - Math.random());
        }

        // Function to handle answer selection
        function selectAnswer(button, selectedChoice, correctAnswer) {
            // Disable all buttons and show the correct answer
            Array.from(choicesEl.children).forEach(btn => {
                btn.disabled = true;
                if (btn.textContent === correctAnswer) {
                    btn.classList.add('correct');
                }
            });

            if (selectedChoice === correctAnswer) {
                // Correct answer
                score++;
                scoreEl.textContent = score;
                button.classList.add('correct');
            } else {
                // Incorrect answer
                button.classList.add('incorrect');
            }
            
            // Show the next button
            nextBtn.classList.remove('hidden');
        }

        // Function to move to the next question
        function showNextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < QUIZ_LENGTH) {
                showQuestion();
            } else {
                showResult();
            }
        }

        // Function to display the final result
        function showResult() {
            quizScreen.classList.add('hidden');
            resultScreen.classList.remove('hidden');

            finalScoreEl.textContent = score;
            finalTotalEl.textContent = QUIZ_LENGTH;

            let message = '';
            const percentage = (score / QUIZ_LENGTH) * 100;
            if (percentage === 100) {
                message = 'Perfect! You are a master of pulsology!';
            } else if (percentage >= 70) {
                message = 'Excellent! With a little more study, you could be an expert.';
            } else if (percentage >= 40) {
                message = 'Good job! Reviewing will lead to even better results.';
            } else {
                message = 'Needs improvement. How about we start over from the beginning?';
            }
            resultMessageEl.textContent = message;
        }

        // Event listeners
        startBtn.addEventListener('click', startQuiz);
        nextBtn.addEventListener('click', showNextQuestion);
        restartBtn.addEventListener('click', startQuiz);

    </script>
</body>
</html>
