<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>처방명의 구조</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Serif+KR:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #F7F3EF;
            font-family: 'Inter', sans-serif;
        }
        .noto-serif {
            font-family: 'Noto Serif KR', serif;
        }
        .btn {
            transition: all 0.2s ease-in-out;
            transform: scale(1);
        }
        .btn.active-action, .btn.active-target {
            color: white;
            transform: scale(1.05);
            box-shadow: 0 4px 14px 0 rgb(0 0 0 / 10%);
        }
        /* Action color is brown */
        .btn.active-action {
            background-color: #A16207; /* amber-700 */
            border-color: #A16207;
        }
        .btn.active-target {
            background-color: #14B8A6; /* teal-500 */
            border-color: #14B8A6;
        }
        .result-card {
            transition: all 0.3s ease-out;
            min-height: 160px;
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Header -->
<header style="width: 100%; max-width: 48rem; margin: 1rem auto; padding: 0 1rem; display: flex; justify-content: space-between; align-items: center;">
    <a href="index.html" 
       style="font-family: serif; font-size: 1.125rem; font-weight: 600; color: rgb(55, 65, 81); text-decoration: none;">
        &larr; Interactive TCM
    </a>
</header>


    <main class="w-full max-w-5xl mx-auto px-4 pb-16">
        <br>
        <div class="text-center mb-10">
            <!-- Title font is sans-serif (Inter) -->
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-2">처방명의 구조</h1>
            <p class="text-base md:text-lg text-gray-600 max-w-3xl mx-auto">가장 일반적인 처방 작명 규칙은 <span class="font-semibold text-amber-700">작용</span>과 그 <span class="font-semibold text-teal-600">대상</span>을 결합하는 것입니다. 각 카테고리에서 버튼을 클릭하여 어떻게 결합되는지 확인해 보세요.</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-12">
            <!-- Actions Section -->
            <div>
                <h2 class="text-2xl font-bold mb-4 noto-serif text-amber-700 text-center">작용</h2>
                <!-- Centered the container -->
                <div id="actions-container" class="flex flex-wrap justify-center gap-3">
                    <!-- Action buttons will be injected here -->
                </div>
            </div>

            <!-- Targets Section -->
            <div>
                <h2 class="text-2xl font-bold mb-4 noto-serif text-teal-500 text-center">대상</h2>
                <!-- Centered the container -->
                <div id="targets-container" class="flex flex-wrap justify-center gap-3">
                    <!-- Target buttons will be injected here -->
                </div>
            </div>
        </div>

        <!-- Combination Result Section -->
        <div class="mt-12">
            <!-- Icon has been removed -->
            <div id="result-card" class="result-card bg-white rounded-xl shadow-lg p-6 md:p-8 border border-gray-200 flex flex-col justify-center items-center text-center">
                <p id="result-placeholder" class="text-gray-500">작용과 대상을 선택하여 결과를 확인하세요.</p>
                <div id="result-content" class="hidden">
                    <h3 id="combined-term" class="text-3xl md:text-4xl font-bold text-gray-800"></h3>
                    <p id="combined-meaning" class="text-lg md:text-xl text-gray-600 mt-2"></p>
                    <div id="example-container" class="mt-4 pt-4 border-t border-gray-200 w-full hidden">
                          <p class="text-sm text-gray-500 mb-1">처방 예시:</p>
                          <p id="example-formula" class="text-xl font-semibold text-gray-700 leading-relaxed"></p>
                    </div>
                </div>
            </div>
            <div class="text-center mt-4">
                <button id="clear-button" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-lg font-medium hover:bg-gray-300 transition-colors">선택 해제</button>
            </div>
        </div>

        <!-- Answer Key Section -->
        <div class="mt-16 text-center border-t pt-8">
            <button id="toggle-answers-btn" class="bg-gray-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-gray-700 transition-colors">
                숨겨진 모든 처방 보기
            </button>
            <div id="answer-key-list" class="hidden mt-6 bg-white p-6 rounded-xl shadow-lg text-left max-w-2xl mx-auto">
                <!-- The list of formulas will be generated here by JS -->
            </div>
        </div>

    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // 한글로 번역된 작용 데이터
            const actions = {
                '사': '과도한 것을 배출',
                '청': '열을 내림',
                '소': '제거',
                '보': '보강',
                '건': '보강',
                '익': '보강',
                '평': '진정',
                '온': '따뜻하게 하고 보강',
                '리': '조절'
            };

            // 한글로 번역된 대상 데이터
            const targets = {
                '심': '심장',
                '담': '담낭',
                '간': '간',
                '비': '비장',
                '위': '위',
                '폐': '폐',
                '중': '중초',
                '황': '노란색, 토(土)와 비장을 의미',
                '백': '흰색, 금(金)과 폐를 의미',
                '풍': '풍(風)',
                '혈': '혈(血)',
                '기': '기(氣), 에너지',
                '독': '독소',
                '경': '경락, 월경'
            };

            // 한글로 번역된 처방 예시 데이터
            const examples = {
                '사간': '용담사간탕',
                '사심': '반하사심탕',
                '사황': '사황산',
                '사백': '사백산',
                '청위': '청위산',
                '청간': '청간명목탕',
                '청심': '우황청심원',
                '청폐': '청기화담환',
                '청혈': '청혈사물탕',
                '청경': '청기화담환', // 별칭
                '청기': '청기화담환',  // 별칭
                '보혈': '당귀보혈탕',
                '보심': '천왕보심단',
                '보폐': '보폐원탕',
                '보중': '보중익기탕',
                '건중': '소건중탕',
                '건비': '건비환',
                '소풍': '소풍산',
                '소독': '보제소독음, 오미소독음',
                '평위': '평위산',
                '온경': '온경탕',
                '온담': '온담탕',
                '리중': '리중환',
                '리기': '리기거풍산',
                '익기': '보중익기탕'
            };

            const actionsContainer = document.getElementById('actions-container');
            const targetsContainer = document.getElementById('targets-container');
            
            let selectedAction = null;
            let selectedTarget = null;

            // Function to create a button element
            const createButton = (term, meaning, type) => {
                const button = document.createElement('button');
                button.className = `btn bg-white border border-gray-300 rounded-lg px-4 py-2 text-left shadow-sm hover:border-gray-400 hover:bg-gray-50`;
                button.innerHTML = `<span class="font-bold text-lg">${term}</span><br><span class="text-sm text-gray-600">${meaning}</span>`;
                button.dataset.term = term;
                button.dataset.type = type;
                button.dataset.meaning = meaning;
                return button;
            };

            // Populate action buttons
            for (const term in actions) {
                const btn = createButton(term, actions[term], 'action');
                actionsContainer.appendChild(btn);
            }

            // Populate target buttons
            for (const term in targets) {
                const btn = createButton(term, targets[term], 'target');
                targetsContainer.appendChild(btn);
            }

            const allButtons = document.querySelectorAll('.btn');
            const resultPlaceholder = document.getElementById('result-placeholder');
            const resultContent = document.getElementById('result-content');
            const combinedTermEl = document.getElementById('combined-term');
            const combinedMeaningEl = document.getElementById('combined-meaning');
            const exampleContainer = document.getElementById('example-container');
            const exampleFormulaEl = document.getElementById('example-formula');
            const clearButton = document.getElementById('clear-button');

            // Event handler for button clicks
            allButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const { term, type, meaning } = button.dataset;

                    if (type === 'action') {
                        document.querySelectorAll('.btn[data-type="action"]').forEach(b => b.classList.remove('active-action'));
                        button.classList.add('active-action');
                        selectedAction = { term, meaning };
                    } else if (type === 'target') {
                        document.querySelectorAll('.btn[data-type="target"]').forEach(b => b.classList.remove('active-target'));
                        button.classList.add('active-target');
                        selectedTarget = { term, meaning };
                    }

                    updateResult();
                });
            });

            // Function to update the result display
            const updateResult = () => {
                if (selectedAction && selectedTarget) {
                    const term = `${selectedAction.term} ${selectedTarget.term}`;
                    const meaning = `${selectedAction.meaning} ${selectedTarget.meaning}`;
                    
                    // 키를 조합합니다 (예: "건" + "비" -> "건비")
                    const exampleKey = `${selectedAction.term}${selectedTarget.term}`;
                    
                    resultPlaceholder.classList.add('hidden');
                    resultContent.classList.remove('hidden');
                    
                    combinedTermEl.textContent = term;
                    combinedMeaningEl.textContent = meaning;

                    if (examples[exampleKey]) {
                        // Handle multiple formulas in one entry
                        const formulaText = examples[exampleKey].replace(/, /g, '<br>');
                        exampleFormulaEl.innerHTML = formulaText;
                        exampleContainer.classList.remove('hidden');
                    } else {
                        exampleContainer.classList.add('hidden');
                    }
                }
            };
            
            // Event handler for the clear button
            clearButton.addEventListener('click', () => {
                selectedAction = null;
                selectedTarget = null;
                allButtons.forEach(b => {
                    b.classList.remove('active-action');
                    b.classList.remove('active-target');
                });
                
                resultPlaceholder.classList.remove('hidden');
                resultContent.classList.add('hidden');
                exampleContainer.classList.add('hidden');
            });

            // --- Answer Key Logic ---
            const toggleBtn = document.getElementById('toggle-answers-btn');
            const answerListDiv = document.getElementById('answer-key-list');

            // Get unique, sorted list of formulas, splitting combined ones
            const allFormulas = [...new Set(Object.values(examples).flatMap(f => f.split(', ')))].sort();

            // Create the list HTML
            const ul = document.createElement('ul');
            ul.className = 'list-disc list-inside grid grid-cols-1 sm:grid-cols-2 gap-x-8 gap-y-2';
            allFormulas.forEach(formula => {
                const li = document.createElement('li');
                li.textContent = formula;
                ul.appendChild(li);
            });
            answerListDiv.appendChild(ul);

            // Toggle visibility on click
            toggleBtn.addEventListener('click', () => {
                const isHidden = answerListDiv.classList.contains('hidden');
                if (isHidden) {
                    answerListDiv.classList.remove('hidden');
                    toggleBtn.textContent = '처방 목록 숨기기';
                } else {
                    answerListDiv.classList.add('hidden');
                    toggleBtn.textContent = '숨겨진 모든 처방 보기';
                }
            });
        });
    </script>
</body>
</html>
